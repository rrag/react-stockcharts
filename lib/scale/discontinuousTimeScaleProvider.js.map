{"version":3,"sources":["../../src/lib/scale/discontinuousTimeScaleProvider.js"],"names":["discontinuousTimeScaleProviderBuilder","evaluateLevel","d","date","i","formatters","map","eachLevel","idx","level","length","format","find","l","discontinuousIndexCalculator","windowSize","undefinedValue","initialIndex","row","getTime","startOf30Seconds","startOfMinute","startOf5Minutes","startOf15Minutes","startOf30Minutes","startOfHour","startOfEighthOfADay","startOfQuarterDay","startOfHalfDay","startOfDay","startOfWeek","startOfMonth","startOfQuarter","startOfYear","index","discontinuousIndexCalculatorLocalTime","accumulator","prevDate","nowDate","getSeconds","getMinutes","getHours","getDay","getMonth","getFullYear","console","log","doStuff","realDateAccessor","inputDateAccessor","data","dateAccessor","calculate","source","misc","each","Date","indexAccessor","indexMutator","withIndex","currentFormatters","discontinuousTimeScaleProvider","response","inputIndex","xScale","mergedData","combine","finalData","xAccessor","displayXAccessor","x","arguments","utc","offsetInMillis","getTimezoneOffset","setLocale","locale","indexCalculator"],"mappings":"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","file":"discontinuousTimeScaleProvider.js","sourcesContent":["\r\n\r\nimport { timeFormat, timeFormatDefaultLocale } from \"d3-time-format\";\r\n// import { map as d3Map } from \"d3-collection\";\r\n\r\nimport financeDiscontinuousScale from \"./financeDiscontinuousScale\";\r\nimport { slidingWindow, zipper, identity, isNotDefined } from \"../utils\";\r\nimport { defaultFormatters, levelDefinition } from \"./levels\";\r\n\r\nfunction evaluateLevel(d, date, i, formatters) {\r\n\treturn levelDefinition\r\n\t\t.map((eachLevel, idx) => {\r\n\t\t\treturn {\r\n\t\t\t\tlevel: levelDefinition.length - idx - 1,\r\n\t\t\t\tformat: formatters[eachLevel(d, date, i)]\r\n\t\t\t};\r\n\t\t})\r\n\t\t.find(l => !!l.format);\r\n}\r\n\r\nconst discontinuousIndexCalculator = slidingWindow()\r\n\t.windowSize(2)\r\n\t.undefinedValue((d, idx, { initialIndex, formatters }) => {\r\n\t\tconst i = initialIndex;\r\n\t\tconst row = {\r\n\t\t\tdate: d.getTime(),\r\n\t\t\tstartOf30Seconds: false,\r\n\t\t\tstartOfMinute: false,\r\n\t\t\tstartOf5Minutes: false,\r\n\t\t\tstartOf15Minutes: false,\r\n\t\t\tstartOf30Minutes: false,\r\n\t\t\tstartOfHour: false,\r\n\t\t\tstartOfEighthOfADay: false,\r\n\t\t\tstartOfQuarterDay: false,\r\n\t\t\tstartOfHalfDay: false,\r\n\t\t\tstartOfDay: true,\r\n\t\t\tstartOfWeek: false,\r\n\t\t\tstartOfMonth: false,\r\n\t\t\tstartOfQuarter: false,\r\n\t\t\tstartOfYear: false,\r\n\t\t};\r\n\t\tconst level = evaluateLevel(row, d, i, formatters);\r\n\t\treturn { ...row, index: i, ...level };\r\n\t});\r\n\r\nconst discontinuousIndexCalculatorLocalTime = discontinuousIndexCalculator\r\n\t.accumulator(([prevDate, nowDate], i, idx, { initialIndex, formatters }) => {\r\n\t\tconst startOf30Seconds = nowDate.getSeconds() % 30 === 0;\r\n\r\n\t\tconst startOfMinute = nowDate.getMinutes() !== prevDate.getMinutes();\r\n\t\tconst startOf5Minutes = startOfMinute && nowDate.getMinutes() % 5 <= prevDate.getMinutes() % 5;\r\n\t\tconst startOf15Minutes = startOfMinute && nowDate.getMinutes() % 15 <= prevDate.getMinutes() % 15;\r\n\t\tconst startOf30Minutes = startOfMinute && nowDate.getMinutes() % 30 <= prevDate.getMinutes() % 30;\r\n\r\n\t\tconst startOfHour = nowDate.getHours() !== prevDate.getHours();\r\n\r\n\t\tconst startOfEighthOfADay = startOfHour && nowDate.getHours() % 3 === 0;\r\n\t\tconst startOfQuarterDay = startOfHour && nowDate.getHours() % 6 === 0;\r\n\t\tconst startOfHalfDay = startOfHour && nowDate.getHours() % 12 === 0;\r\n\r\n\t\tconst startOfDay = nowDate.getDay() !== prevDate.getDay();\r\n\t\t// According to ISO calendar\r\n\t\t// Sunday = 0, Monday = 1, ... Saturday = 6\r\n\t\t// day of week of today < day of week of yesterday then today is start of week\r\n\t\tconst startOfWeek = nowDate.getDay() < prevDate.getDay();\r\n\t\t// month of today != month of yesterday then today is start of month\r\n\t\tconst startOfMonth = nowDate.getMonth() !== prevDate.getMonth();\r\n\t\t// if start of month and month % 3 === 0 then it is start of quarter\r\n\t\tconst startOfQuarter = startOfMonth && (nowDate.getMonth() % 3 <= prevDate.getMonth() % 3);\r\n\t\t// year of today != year of yesterday then today is start of year\r\n\t\tconst startOfYear = nowDate.getFullYear() !== prevDate.getFullYear();\r\n\r\n\t\tconst row = {\r\n\t\t\tdate: nowDate.getTime(),\r\n\t\t\tstartOf30Seconds,\r\n\t\t\tstartOfMinute,\r\n\t\t\tstartOf5Minutes,\r\n\t\t\tstartOf15Minutes,\r\n\t\t\tstartOf30Minutes,\r\n\t\t\tstartOfHour,\r\n\t\t\tstartOfEighthOfADay,\r\n\t\t\tstartOfQuarterDay,\r\n\t\t\tstartOfHalfDay,\r\n\t\t\tstartOfDay,\r\n\t\t\tstartOfWeek,\r\n\t\t\tstartOfMonth,\r\n\t\t\tstartOfQuarter,\r\n\t\t\tstartOfYear,\r\n\t\t};\r\n\t\tconst level = evaluateLevel(row, nowDate, i, formatters);\r\n\t\tif (level == null) {\r\n\t\t\tconsole.log(row);\r\n\t\t}\r\n\t\treturn { ...row, index: i + initialIndex, ...level };\r\n\t});\r\n\r\nfunction doStuff(realDateAccessor, inputDateAccessor, initialIndex, formatters) {\r\n\treturn function(data) {\r\n\t\tconst dateAccessor = realDateAccessor(inputDateAccessor);\r\n\t\tconst calculate = discontinuousIndexCalculatorLocalTime\r\n\t\t\t.source(dateAccessor)\r\n\t\t\t.misc({ initialIndex, formatters });\r\n\r\n\t\tconst index = calculate(data).map(each => {\r\n\t\t\tconst { format } = each;\r\n\t\t\treturn {\r\n\t\t\t\t// ...each,\r\n\t\t\t\tindex: each.index,\r\n\t\t\t\tlevel: each.level,\r\n\t\t\t\tdate: new Date(each.date),\r\n\t\t\t\tformat: timeFormat(format),\r\n\t\t\t};\r\n\t\t});\r\n\t\t/*\r\n\t\tvar map = d3Map();\r\n\t\tfor (var i = 0; i < data.length - 1; i++) {\r\n\r\n\t\t\tvar nextDate = dateAccessor(data[i + 1]);\r\n\t\t\tvar nowDate = dateAccessor(data[i]);\r\n\t\t\tvar diff = nextDate - nowDate;\r\n\r\n\t\t\tif (map.has(diff)) {\r\n\t\t\t\tvar count = parseInt(map.get(diff), 10) + 1;\r\n\t\t\t\tmap.set(diff, count);\r\n\t\t\t} else {\r\n\t\t\t\tmap.set(diff, 1);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar entries = map.entries().sort((a, b) => a.value < b.value);\r\n\r\n\t\t// For Renko/p&f\r\n\r\n\t\tvar interval = entries[0].value === 1\r\n\t\t\t? Math.round((dateAccessor(last(data)) - dateAccessor(head(data))) / data.length)\r\n\t\t\t: parseInt(entries[0].key, 10); */\r\n\r\n\t\t// return { index, interval };\r\n\t\treturn { index };\r\n\t};\r\n}\r\n\r\nexport function discontinuousTimeScaleProviderBuilder() {\r\n\tlet initialIndex = 0, realDateAccessor = identity;\r\n\tlet inputDateAccessor = d => d.date,\r\n\t\tindexAccessor = d => d.idx,\r\n\t\tindexMutator = (d, idx) => ({ ...d, idx }),\r\n\t\twithIndex;\r\n\r\n\tlet currentFormatters = defaultFormatters;\r\n\r\n\t// eslint-disable-next-line prefer-const\r\n\tlet discontinuousTimeScaleProvider = function(data) {\r\n\t\t/*\r\n\t\tconsole.warn(\"Are you sure you want to use a discontinuousTimeScale?\"\r\n\t\t\t+ \" Use this only if you have discontinuous data which\"\r\n\t\t\t+ \" needs to be displayed as continuous.\"\r\n\t\t\t+ \" If you have continuous data use a d3 scale like\"\r\n\t\t\t+ \" `d3.scaleTime`\"\r\n\t\t);\r\n\t\t*/\r\n\r\n\t\tlet index = withIndex;\r\n\r\n\t\tif (isNotDefined(index)) {\r\n\t\t\tconst response = doStuff(\r\n\t\t\t\trealDateAccessor,\r\n\t\t\t\tinputDateAccessor,\r\n\t\t\t\tinitialIndex,\r\n\t\t\t\tcurrentFormatters\r\n\t\t\t)(data);\r\n\r\n\t\t\tindex = response.index;\r\n\t\t}\r\n\t\t// console.log(interval, entries[0].key);\r\n\r\n\t\tconst inputIndex = index;\r\n\t\tconst xScale = financeDiscontinuousScale(\r\n\t\t\tinputIndex,\r\n\t\t);\r\n\r\n\t\tconst mergedData = zipper()\r\n\t\t\t.combine(indexMutator);\r\n\r\n\t\tconst finalData = mergedData(data, inputIndex);\r\n\r\n\t\treturn {\r\n\t\t\tdata: finalData,\r\n\t\t\txScale,\r\n\t\t\txAccessor: d => d && indexAccessor(d).index,\r\n\t\t\tdisplayXAccessor: realDateAccessor(inputDateAccessor),\r\n\t\t};\r\n\t};\r\n\r\n\tdiscontinuousTimeScaleProvider.initialIndex = function(x) {\r\n\t\tif (!arguments.length) {\r\n\t\t\treturn initialIndex;\r\n\t\t}\r\n\t\tinitialIndex = x;\r\n\t\treturn discontinuousTimeScaleProvider;\r\n\t};\r\n\tdiscontinuousTimeScaleProvider.inputDateAccessor = function(x) {\r\n\t\tif (!arguments.length) {\r\n\t\t\treturn inputDateAccessor;\r\n\t\t}\r\n\t\tinputDateAccessor = x;\r\n\t\treturn discontinuousTimeScaleProvider;\r\n\t};\r\n\tdiscontinuousTimeScaleProvider.indexAccessor = function(x) {\r\n\t\tif (!arguments.length) {\r\n\t\t\treturn indexAccessor;\r\n\t\t}\r\n\t\tindexAccessor = x;\r\n\t\treturn discontinuousTimeScaleProvider;\r\n\t};\r\n\tdiscontinuousTimeScaleProvider.indexMutator = function(x) {\r\n\t\tif (!arguments.length) {\r\n\t\t\treturn indexMutator;\r\n\t\t}\r\n\t\tindexMutator = x;\r\n\t\treturn discontinuousTimeScaleProvider;\r\n\t};\r\n\tdiscontinuousTimeScaleProvider.withIndex = function(x) {\r\n\t\tif (!arguments.length) {\r\n\t\t\treturn withIndex;\r\n\t\t}\r\n\t\twithIndex = x;\r\n\t\treturn discontinuousTimeScaleProvider;\r\n\t};\r\n\tdiscontinuousTimeScaleProvider.utc = function() {\r\n\t\trealDateAccessor = dateAccessor => d => {\r\n\t\t\tconst date = dateAccessor(d);\r\n\t\t\t// The getTimezoneOffset() method returns the time-zone offset from UTC, in minutes, for the current locale.\r\n\t\t\tconst offsetInMillis = date.getTimezoneOffset() * 60 * 1000;\r\n\t\t\treturn new Date(date.getTime() + offsetInMillis);\r\n\t\t};\r\n\t\treturn discontinuousTimeScaleProvider;\r\n\t};\r\n\tdiscontinuousTimeScaleProvider.setLocale = function(locale, formatters = null) {\r\n\t\tif (locale) {\r\n\t\t\ttimeFormatDefaultLocale(locale);\r\n\t\t}\r\n\t\tif (formatters) {\r\n\t\t\tcurrentFormatters = formatters;\r\n\t\t}\r\n\t\treturn discontinuousTimeScaleProvider;\r\n\t};\r\n\r\n\tdiscontinuousTimeScaleProvider.indexCalculator = function() {\r\n\t\treturn doStuff(realDateAccessor, inputDateAccessor, initialIndex, currentFormatters);\r\n\t};\r\n\r\n\treturn discontinuousTimeScaleProvider;\r\n}\r\n\r\n\r\n\r\n/* discontinuousTimeScaleProvider.utc = function(data,\r\n\t\tdateAccessor,\r\n\t\tindexAccessor,\r\n\t\tindexMutator) {\r\n\tvar utcDateAccessor = d => {\r\n\t\tvar date = dateAccessor(d);\r\n\t\t// The getTimezoneOffset() method returns the time-zone offset from UTC, in minutes, for the current locale.\r\n\t\tvar offsetInMillis = date.getTimezoneOffset() * 60 * 1000;\r\n\t\treturn new Date(date.getTime() + offsetInMillis);\r\n\t};\r\n\treturn discontinuousTimeScaleProvider(data, utcDateAccessor, indexAccessor, indexMutator);\r\n};*/\r\n\r\nexport default discontinuousTimeScaleProviderBuilder();\r\n"]}