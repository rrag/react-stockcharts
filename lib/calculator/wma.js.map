{"version":3,"sources":["../../src/lib/calculator/wma.js"],"names":["options","calculator","data","windowSize","sourcePath","weight","waverage","accumulator","total","values","v","i","undefinedLength","x","arguments","length"],"mappings":";;;;;;;;kBAOe,YAAW;;AAEzB,KAAIA,2CAAJ;;AAEA,UAASC,UAAT,CAAoBC,IAApB,EAA6B;AAAA,iBACOF,OADP;AAAA,MACpBG,UADoB,YACpBA,UADoB;AAAA,MACRC,UADQ,YACRA,UADQ;;;AAG5B,MAAMC,SAASF,cAAcA,aAAa,CAA3B,IAAgC,CAA/C;;AAEA,MAAMG,WAAW,4BACfH,UADe,CACJA,UADI,EAEfC,UAFe,CAEJA,UAFI,EAGfG,WAHe,CAGH,kBAAU;AACtB,OAAMC,QAAQ,kBAAIC,MAAJ,EAAY,UAACC,CAAD,EAAIC,CAAJ,EAAU;AACnC,WAAO,CAACA,IAAI,CAAL,IAAUD,CAAjB;AACA,IAFa,CAAd;AAGA,UAAOF,QAAQH,MAAf;AACA,GARe,CAAjB;;AAUA,SAAOC,SAASJ,IAAT,CAAP;AACA;AACDD,YAAWW,eAAX,GAA6B,YAAW;AAAA,kBAChBZ,OADgB;AAAA,MAC/BG,UAD+B,aAC/BA,UAD+B;;;AAGvC,SAAOA,aAAa,CAApB;AACA,EAJD;AAKAF,YAAWD,OAAX,GAAqB,UAASa,CAAT,EAAY;AAChC,MAAI,CAACC,UAAUC,MAAf,EAAuB;AACtB,UAAOf,OAAP;AACA;AACDA,4DAAkCa,CAAlC;AACA,SAAOZ,UAAP;AACA,EAND;;AAQA,QAAOA,UAAP;AACA,C;;AAxCD;;AAEA;;AACA","file":"wma.js","sourcesContent":["\r\n\r\nimport { sum } from \"d3-array\";\r\n\r\nimport { slidingWindow } from \"../utils\";\r\nimport { WMA as defaultOptions } from \"./defaultOptionsForComputation\";\r\n\r\nexport default function() {\r\n\r\n\tlet options = defaultOptions;\r\n\r\n\tfunction calculator(data)    {\r\n\t\tconst { windowSize, sourcePath } = options;\r\n\r\n\t\tconst weight = windowSize * (windowSize + 1) / 2;\r\n\r\n\t\tconst waverage = slidingWindow()\r\n\t\t\t.windowSize(windowSize)\r\n\t\t\t.sourcePath(sourcePath)\r\n\t\t\t.accumulator(values => {\r\n\t\t\t\tconst total = sum(values, (v, i) => {\r\n\t\t\t\t\treturn (i + 1) * v;\r\n\t\t\t\t});\r\n\t\t\t\treturn total / weight;\r\n\t\t\t});\r\n\r\n\t\treturn waverage(data);\r\n\t}\r\n\tcalculator.undefinedLength = function() {\r\n\t\tconst { windowSize } = options;\r\n\r\n\t\treturn windowSize - 1;\r\n\t};\r\n\tcalculator.options = function(x) {\r\n\t\tif (!arguments.length) {\r\n\t\t\treturn options;\r\n\t\t}\r\n\t\toptions = { ...defaultOptions, ...x };\r\n\t\treturn calculator;\r\n\t};\r\n\r\n\treturn calculator;\r\n}\r\n"]}