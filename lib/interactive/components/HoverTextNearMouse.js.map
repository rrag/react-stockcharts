{"version":3,"sources":["../../../src/lib/interactive/components/HoverTextNearMouse.js"],"names":["PADDING","MIN_WIDTH","HoverTextNearMouse","props","state","textWidth","undefined","textHeight","saveNode","bind","updateTextSize","renderSVG","node","textNode","bgWidth","bgHeight","getBBox","width","height","setState","moreProps","fontFamily","fontSize","fill","bgFill","bgOpacity","textMetaData","helper","getBgWidth","getBgHeight","rect","text","x","y","numberOrString","oneOfType","number","oneOf","propTypes","string","isRequired","show","bool","defaultProps","mouseXY","chartConfig","mouseInsideCanvas","cx","cy"],"mappings":"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","file":"HoverTextNearMouse.js","sourcesContent":["import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nimport GenericChartComponent from \"../../GenericChartComponent\";\r\nimport { isDefined } from \"../../utils\";\r\n\r\nconst PADDING = 10;\r\nconst MIN_WIDTH = PADDING;\r\n\r\nclass HoverTextNearMouse extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {\r\n\t\t\ttextWidth: undefined,\r\n\t\t\ttextHeight: undefined,\r\n\t\t};\r\n\r\n\t\tthis.saveNode = this.saveNode.bind(this);\r\n\t\tthis.updateTextSize = this.updateTextSize.bind(this);\r\n\t\tthis.renderSVG = this.renderSVG.bind(this);\r\n\t}\r\n\tsaveNode(node) {\r\n\t\tthis.textNode = node;\r\n\t}\r\n\r\n\tupdateTextSize() {\r\n\t\tconst { bgWidth, bgHeight } = this.props;\r\n\t\tif (bgWidth === \"auto\" || bgHeight === \"auto\") {\r\n\t\t\tconst textNode = this.textNode;\r\n\t\t\tif (textNode) {\r\n\t\t\t\tconst { width, height } = textNode.getBBox();\r\n\t\t\t\tif (this.state.textWidth !== width || this.state.textHeight !== height) {\r\n\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\ttextWidth: width,\r\n\t\t\t\t\t\ttextHeight: height\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.updateTextSize();\r\n\t}\r\n\r\n\tcomponentDidUpdate() {\r\n\t\tthis.updateTextSize();\r\n\t}\r\n\r\n\tgetBgWidth() {\r\n\t\tconst { bgWidth } = this.props;\r\n\t\tconst { textWidth } = this.state;\r\n\r\n\t\tif (bgWidth !== \"auto\") {\r\n\t\t\treturn bgWidth;\r\n\t\t} else if (textWidth !== undefined) {\r\n\t\t\treturn textWidth + PADDING;\r\n\t\t} else {\r\n\t\t\treturn MIN_WIDTH;\r\n\t\t}\r\n\t}\r\n\r\n\tgetBgHeight() {\r\n\t\tconst { bgHeight } = this.props;\r\n\t\tconst { textHeight } = this.state;\r\n\r\n\t\tif (bgHeight !== \"auto\") {\r\n\t\t\treturn bgHeight;\r\n\t\t} else if (textHeight !== undefined) {\r\n\t\t\treturn textHeight + PADDING;\r\n\t\t} else {\r\n\t\t\treturn MIN_WIDTH;\r\n\t\t}\r\n\t}\r\n\r\n\trenderSVG(moreProps) {\r\n\t\tconst {\r\n\t\t\tfontFamily,\r\n\t\t\tfontSize,\r\n\t\t\tfill,\r\n\t\t\tbgFill,\r\n\t\t\tbgOpacity,\r\n\t\t} = this.props;\r\n\r\n\t\t// console.log(moreProps)\r\n\t\tconst textMetaData = helper({\r\n\t\t\t...this.props,\r\n\t\t\tbgWidth: this.getBgWidth(),\r\n\t\t\tbgHeight: this.getBgHeight()\r\n\t\t}, moreProps);\r\n\r\n\t\tif (isDefined(textMetaData)) {\r\n\t\t\tconst { rect, text } = textMetaData;\r\n\t\t\treturn (\r\n\t\t\t\t<g>\r\n\t\t\t\t\t<rect\r\n\t\t\t\t\t\tfill={bgFill}\r\n\t\t\t\t\t\tfillOpacity={bgOpacity}\r\n\t\t\t\t\t\tstroke={bgFill}\r\n\t\t\t\t\t\t{...rect}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<text\r\n\t\t\t\t\t\tref={this.saveNode}\r\n\t\t\t\t\t\tfontSize={fontSize}\r\n\t\t\t\t\t\tfontFamily={fontFamily}\r\n\t\t\t\t\t\ttextAnchor=\"start\"\r\n\t\t\t\t\t\talignmentBaseline={\"central\"}\r\n\t\t\t\t\t\tfill={fill}\r\n\t\t\t\t\t\tx={text.x}\r\n\t\t\t\t\t\ty={text.y}>{text.text}</text>\r\n\t\t\t\t</g>\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\trender() {\r\n\t\tconst { text } = this.props;\r\n\t\tif (text) {\r\n\t\t\treturn <GenericChartComponent\r\n\t\t\t\tsvgDraw={this.renderSVG}\r\n\t\t\t\tdrawOn={[\"mousemove\"]}\r\n\t\t\t/>;\r\n\t\t} else {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nconst numberOrString = PropTypes.oneOfType([\r\n\tPropTypes.number,\r\n\tPropTypes.oneOf([\"auto\"]),\r\n]);\r\n\r\nHoverTextNearMouse.propTypes = {\r\n\tfontFamily: PropTypes.string.isRequired,\r\n\tfontSize: PropTypes.number.isRequired,\r\n\tfill: PropTypes.string.isRequired,\r\n\ttext: PropTypes.string.isRequired,\r\n\tbgFill: PropTypes.string.isRequired,\r\n\tbgOpacity: PropTypes.number.isRequired,\r\n\tbgWidth: numberOrString.isRequired,\r\n\tbgHeight: numberOrString.isRequired,\r\n\tshow: PropTypes.bool.isRequired,\r\n};\r\n\r\nHoverTextNearMouse.defaultProps = {\r\n\tfontFamily: \"Helvetica Neue, Helvetica, Arial, sans-serif\",\r\n\tfontSize: 12,\r\n\tfill: \"#000000\",\r\n\tbgFill: \"#FA9325\",\r\n\tbgOpacity: 0.5,\r\n};\r\n\r\nfunction helper(props, moreProps) {\r\n\tconst {\r\n\t\tshow,\r\n\t\tbgWidth,\r\n\t\tbgHeight,\r\n\t} = props;\r\n\r\n\tconst {\r\n\t\tmouseXY,\r\n\t\tchartConfig: { height, width },\r\n\t\tshow: mouseInsideCanvas\r\n\t} = moreProps;\r\n\r\n\tif (show && mouseInsideCanvas) {\r\n\t\tconst [x, y] = mouseXY;\r\n\r\n\t\tconst cx = x < width / 2\r\n\t\t\t? x + PADDING\r\n\t\t\t: x - bgWidth - PADDING;\r\n\r\n\t\tconst cy = y < height / 2\r\n\t\t\t? y + PADDING\r\n\t\t\t: y - bgHeight - PADDING;\r\n\r\n\t\tconst rect = {\r\n\t\t\tx: cx,\r\n\t\t\ty: cy,\r\n\t\t\twidth: bgWidth,\r\n\t\t\theight: bgHeight,\r\n\t\t};\r\n\r\n\t\tconst text = {\r\n\t\t\ttext: props.text,\r\n\t\t\tx: cx + PADDING / 2,\r\n\t\t\ty: cy + bgHeight / 2,\r\n\t\t};\r\n\r\n\t\treturn {\r\n\t\t\trect,\r\n\t\t\ttext\r\n\t\t};\r\n\t}\r\n}\r\n\r\nexport default HoverTextNearMouse;\r\n"]}