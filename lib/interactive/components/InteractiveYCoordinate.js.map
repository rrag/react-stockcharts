{"version":3,"sources":["../../../src/lib/interactive/components/InteractiveYCoordinate.js"],"names":["InteractiveYCoordinate","props","renderSVG","bind","drawOnCanvas","isHover","moreProps","onHover","values","helper","x1","x2","y","rect","mouseXY","mouseX","mouseY","x","width","height","Math","abs","ctx","bgFill","bgOpacity","textFill","fontFamily","fontSize","fontStyle","fontWeight","stroke","strokeWidth","strokeOpacity","strokeDasharray","text","textBox","edge","selected","hovering","strokeStyle","beginPath","lineWidth","textBaseline","textAlign","font","padding","left","measureText","right","closeIcon","setLineDash","moveTo","lineTo","fillStyle","fillRect","strokeRect","fillText","newEdge","opacity","yValue","displayFormat","yCoord","Error","interactiveCursorClass","onUnHover","onDragStart","onDrag","onDragComplete","chartConfig","yScale","round","propTypes","string","isRequired","number","oneOfType","object","func","defaultClassName","tolerance","bool","defaultProps"],"mappings":"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","file":"InteractiveYCoordinate.js","sourcesContent":["import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nimport GenericChartComponent from \"../../GenericChartComponent\";\r\nimport { getMouseCanvas } from \"../../GenericComponent\";\r\nimport { isDefined, noop, hexToRGBA, getStrokeDasharrayCanvas } from \"../../utils\";\r\nimport { drawOnCanvas } from \"../../coordinates/EdgeCoordinateV3\";\r\nimport { getYCoordinate } from \"../../coordinates/MouseCoordinateY\";\r\n\r\nclass InteractiveYCoordinate extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.renderSVG = this.renderSVG.bind(this);\r\n\t\tthis.drawOnCanvas = this.drawOnCanvas.bind(this);\r\n\t\tthis.isHover = this.isHover.bind(this);\r\n\t}\r\n\tisHover(moreProps) {\r\n\t\tconst { onHover } = this.props;\r\n\r\n\t\tif (isDefined(onHover)) {\r\n\t\t\tconst values = helper(this.props, moreProps);\r\n\t\t\tif (values == null) return false;\r\n\r\n\t\t\tconst { x1, x2, y, rect } = values;\r\n\t\t\tconst { mouseXY: [mouseX, mouseY] } = moreProps;\r\n\r\n\t\t\tif (\r\n\t\t\t\tmouseX >= rect.x\r\n\t\t\t\t&& mouseX <= rect.x + this.width\r\n\t\t\t\t&& mouseY >= rect.y\r\n\t\t\t\t&& mouseY <= rect.y + rect.height\r\n\t\t\t) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tif (\r\n\t\t\t\tx1 <= mouseX\r\n\t\t\t\t&& x2 >= mouseX\r\n\t\t\t\t&& Math.abs(mouseY - y) < 4\r\n\t\t\t) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\tdrawOnCanvas(ctx, moreProps) {\r\n\t\tconst {\r\n\t\t\tbgFill,\r\n\t\t\tbgOpacity,\r\n\r\n\t\t\ttextFill,\r\n\t\t\tfontFamily,\r\n\t\t\tfontSize,\r\n\r\n\t\t\tfontStyle,\r\n\t\t\tfontWeight,\r\n\t\t\tstroke,\r\n\t\t\tstrokeWidth,\r\n\t\t\tstrokeOpacity,\r\n\t\t\tstrokeDasharray,\r\n\t\t\ttext,\r\n\t\t\ttextBox,\r\n\t\t\tedge,\r\n\t\t} = this.props;\r\n\r\n\t\tconst { selected, hovering } = this.props;\r\n\r\n\t\tconst values = helper(this.props, moreProps);\r\n\t\tif (values == null) return;\r\n\r\n\t\tconst { x1, x2, y, rect } = values;\r\n\r\n\t\tctx.strokeStyle = hexToRGBA(stroke, strokeOpacity);\r\n\r\n\t\tctx.beginPath();\r\n\t\tif (selected || hovering) {\r\n\t\t\tctx.lineWidth = strokeWidth + 1;\r\n\t\t} else {\r\n\t\t\tctx.lineWidth = strokeWidth;\r\n\t\t}\r\n\t\tctx.textBaseline = \"middle\";\r\n\t\tctx.textAlign = \"start\";\r\n\t\tctx.font = `${fontStyle} ${fontWeight} ${fontSize}px ${fontFamily}`;\r\n\r\n\t\tthis.width = textBox.padding.left\r\n\t\t\t+ ctx.measureText(text).width\r\n\t\t\t+ textBox.padding.right\r\n\t\t\t+ textBox.closeIcon.padding.left\r\n\t\t\t+ textBox.closeIcon.width\r\n\t\t\t+ textBox.closeIcon.padding.right;\r\n\r\n\t\tctx.setLineDash(getStrokeDasharrayCanvas(strokeDasharray));\r\n\t\tctx.moveTo(x1, y);\r\n\t\tctx.lineTo(rect.x, y);\r\n\r\n\t\tctx.moveTo(rect.x + this.width, y);\r\n\t\tctx.lineTo(x2, y);\r\n\t\tctx.stroke();\r\n\r\n\t\tctx.setLineDash([]);\r\n\r\n\r\n\t\tctx.fillStyle = hexToRGBA(bgFill, bgOpacity);\r\n\r\n\t\tctx.fillRect(rect.x, rect.y, this.width, rect.height);\r\n\t\tctx.strokeRect(rect.x, rect.y, this.width, rect.height);\r\n\r\n\t\tctx.fillStyle = textFill;\r\n\r\n\t\tctx.beginPath();\r\n\t\tctx.fillText(text, rect.x + 10, y);\r\n\t\tconst newEdge = {\r\n\t\t\t...edge,\r\n\t\t\ttextFill,\r\n\t\t\tfontFamily,\r\n\t\t\tfontSize,\r\n\t\t\topacity: bgOpacity\r\n\t\t};\r\n\t\tconst yValue = edge.displayFormat(this.props.yValue);\r\n\t\tconst yCoord = getYCoordinate(y, yValue, newEdge, moreProps);\r\n\t\tdrawOnCanvas(ctx, yCoord);\r\n\t}\r\n\trenderSVG() {\r\n\t\tthrow new Error(\"svg not implemented\");\r\n\t}\r\n\trender() {\r\n\t\tconst { interactiveCursorClass } = this.props;\r\n\t\tconst { onHover, onUnHover } = this.props;\r\n\t\tconst { onDragStart, onDrag, onDragComplete } = this.props;\r\n\r\n\t\treturn (\r\n\t\t\t<GenericChartComponent\r\n\t\t\t\tclip={false}\r\n\t\t\t\txxxyyy\r\n\t\t\t\tisHover={this.isHover}\r\n\r\n\t\t\t\tsvgDraw={this.renderSVG}\r\n\t\t\t\tcanvasToDraw={getMouseCanvas}\r\n\t\t\t\tcanvasDraw={this.drawOnCanvas}\r\n\r\n\t\t\t\tinteractiveCursorClass={interactiveCursorClass}\r\n\t\t\t\t/* selected={selected} */\r\n\t\t\t\tenableDragOnHover\r\n\r\n\t\t\t\tonDragStart={onDragStart}\r\n\t\t\t\tonDrag={onDrag}\r\n\t\t\t\tonDragComplete={onDragComplete}\r\n\t\t\t\tonHover={onHover}\r\n\t\t\t\tonUnHover={onUnHover}\r\n\r\n\t\t\t\tdrawOn={[\"mousemove\", \"mouseleave\", \"pan\", \"drag\"]}\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nfunction helper(props, moreProps) {\r\n\tconst { yValue, textBox } = props;\r\n\r\n\tconst { chartConfig: { width, yScale, height } } = moreProps;\r\n\r\n\tconst y = Math.round(yScale(yValue));\r\n\r\n\tif (y >= 0 && y <= height) {\r\n\t\tconst rect = {\r\n\t\t\tx: textBox.left,\r\n\t\t\ty: y - textBox.height / 2,\r\n\t\t\theight: textBox.height,\r\n\t\t};\r\n\t\treturn {\r\n\t\t\tx1: 0,\r\n\t\t\tx2: width,\r\n\t\t\ty,\r\n\t\t\trect,\r\n\t\t};\r\n\t}\r\n\r\n}\r\n\r\nInteractiveYCoordinate.propTypes = {\r\n\tbgFill: PropTypes.string.isRequired,\r\n\tbgOpacity: PropTypes.number.isRequired,\r\n\r\n\tstroke: PropTypes.string.isRequired,\r\n\tstrokeWidth: PropTypes.number.isRequired,\r\n\tstrokeOpacity: PropTypes.number.isRequired,\r\n\tstrokeDasharray: PropTypes.string.isRequired,\r\n\r\n\ttextFill: PropTypes.string.isRequired,\r\n\tfontFamily: PropTypes.string.isRequired,\r\n\tfontSize: PropTypes.number.isRequired,\r\n\tfontWeight: PropTypes.oneOfType([\r\n\t\tPropTypes.number,\r\n\t\tPropTypes.string,\r\n\t]).isRequired,\r\n\tfontStyle: PropTypes.string.isRequired,\r\n\r\n\ttext: PropTypes.string.isRequired,\r\n\tedge: PropTypes.object.isRequired,\r\n\ttextBox: PropTypes.object.isRequired,\r\n\tyValue: PropTypes.number.isRequired,\r\n\r\n\tonDragStart: PropTypes.func.isRequired,\r\n\tonDrag: PropTypes.func.isRequired,\r\n\tonDragComplete: PropTypes.func.isRequired,\r\n\tonHover: PropTypes.func,\r\n\tonUnHover: PropTypes.func,\r\n\r\n\tdefaultClassName: PropTypes.string,\r\n\tinteractiveCursorClass: PropTypes.string,\r\n\r\n\ttolerance: PropTypes.number.isRequired,\r\n\tselected: PropTypes.bool.isRequired,\r\n\thovering: PropTypes.bool.isRequired,\r\n};\r\n\r\nInteractiveYCoordinate.defaultProps = {\r\n\tonDragStart: noop,\r\n\tonDrag: noop,\r\n\tonDragComplete: noop,\r\n\r\n\tfontWeight: \"normal\", // standard dev\r\n\r\n\tstrokeWidth: 1,\r\n\ttolerance: 4,\r\n\tselected: false,\r\n\thovering: false,\r\n};\r\n\r\nexport default InteractiveYCoordinate;"]}