{"version":3,"sources":["../../src/lib/interactive/StandardDeviationChannel.js"],"names":["StandardDeviationChannel","props","handleStart","bind","handleEnd","handleDrawLine","handleDragLine","handleDragLineComplete","terminate","saveNodeType","getSelectionState","nodes","state","index","newXYValue","setState","override","moreProps","channels","newChannels","map","each","idx","start","x1Value","y1Value","end","x2Value","y2Value","selected","onComplete","xyValue","current","mouseMoved","onStart","e","appearance","d","enabled","snapTo","currentPositionRadius","currentPositionStroke","currentPositionOpacity","currentPositionStrokeWidth","hoverText","eachDefaultAppearance","defaultProps","hoverTextDefault","tempLine","eachAppearance","eachHoverText","propTypes","bool","isRequired","func","onSelect","string","number","shape","stroke","strokeOpacity","strokeWidth","fill","fillOpacity","edgeStrokeWidth","edgeStroke","edgeFill","r","object","array","close","enable","bgHeight","bgWidth","text","selectedText"],"mappings":"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","file":"StandardDeviationChannel.js","sourcesContent":["\r\n\r\nimport React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nimport { isDefined, isNotDefined, noop } from \"../utils\";\r\n\r\nimport {\r\n\tgetValueFromOverride,\r\n\tterminate,\r\n\tsaveNodeType,\r\n\tisHoverForInteractiveType,\r\n} from \"./utils\";\r\n\r\nimport EachLinearRegressionChannel from \"./wrapper/EachLinearRegressionChannel\";\r\nimport MouseLocationIndicator from \"./components/MouseLocationIndicator\";\r\nimport HoverTextNearMouse from \"./components/HoverTextNearMouse\";\r\n\r\nclass StandardDeviationChannel extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.handleStart = this.handleStart.bind(this);\r\n\t\tthis.handleEnd = this.handleEnd.bind(this);\r\n\t\tthis.handleDrawLine = this.handleDrawLine.bind(this);\r\n\t\tthis.handleDragLine = this.handleDragLine.bind(this);\r\n\t\tthis.handleDragLineComplete = this.handleDragLineComplete.bind(this);\r\n\r\n\t\tthis.terminate = terminate.bind(this);\r\n\t\tthis.saveNodeType = saveNodeType.bind(this);\r\n\r\n\t\tthis.getSelectionState = isHoverForInteractiveType(\"channels\")\r\n\t\t\t.bind(this);\r\n\r\n\t\tthis.nodes = [];\r\n\t\tthis.state = {};\r\n\t}\r\n\thandleDragLine(index, newXYValue) {\r\n\t\tthis.setState({\r\n\t\t\toverride: {\r\n\t\t\t\tindex,\r\n\t\t\t\t...newXYValue\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\thandleDragLineComplete(moreProps) {\r\n\t\tconst { override } = this.state;\r\n\t\tconst { channels } = this.props;\r\n\t\tif (isDefined(override)) {\r\n\r\n\t\t\tconst newChannels = channels\r\n\t\t\t\t.map((each, idx) => idx === override.index\r\n\t\t\t\t\t? {\r\n\t\t\t\t\t\t...each,\r\n\t\t\t\t\t\tstart: [override.x1Value, override.y1Value],\r\n\t\t\t\t\t\tend: [override.x2Value, override.y2Value],\r\n\t\t\t\t\t\tselected: true,\r\n\t\t\t\t\t}\r\n\t\t\t\t\t: each);\r\n\t\t\tthis.setState({\r\n\t\t\t\toverride: null,\r\n\t\t\t}, () => {\r\n\t\t\t\tthis.props.onComplete(newChannels, moreProps);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\thandleDrawLine(xyValue) {\r\n\t\tconst { current } = this.state;\r\n\r\n\t\tif (isDefined(current) && isDefined(current.start)) {\r\n\t\t\tthis.mouseMoved = true;\r\n\t\t\tthis.setState({\r\n\t\t\t\tcurrent: {\r\n\t\t\t\t\tstart: current.start,\r\n\t\t\t\t\tend: xyValue,\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\thandleStart(xyValue) {\r\n\t\tconst { current } = this.state;\r\n\r\n\t\tif (isNotDefined(current) || isNotDefined(current.start)) {\r\n\t\t\tthis.mouseMoved = false;\r\n\r\n\t\t\tthis.setState({\r\n\t\t\t\tcurrent: {\r\n\t\t\t\t\tstart: xyValue,\r\n\t\t\t\t\tend: null,\r\n\t\t\t\t}\r\n\t\t\t}, () => {\r\n\t\t\t\tthis.props.onStart();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\thandleEnd(xyValue, moreProps, e) {\r\n\t\tconst { current } = this.state;\r\n\t\tconst { appearance, channels } = this.props;\r\n\r\n\t\tif (this.mouseMoved\r\n\t\t\t&& isDefined(current)\r\n\t\t\t&& isDefined(current.start)\r\n\t\t) {\r\n\t\t\tconst newChannels = [\r\n\t\t\t\t...channels.map(d => ({ ...d, selected: false })),\r\n\t\t\t\t{\r\n\t\t\t\t\tstart: current.start,\r\n\t\t\t\t\tend: xyValue,\r\n\t\t\t\t\tselected: true,\r\n\t\t\t\t\tappearance,\r\n\t\t\t\t}\r\n\t\t\t];\r\n\r\n\t\t\tthis.setState({\r\n\t\t\t\tcurrent: null,\r\n\t\t\t}, () => {\r\n\t\t\t\tthis.props.onComplete(newChannels, moreProps, e);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\trender() {\r\n\t\tconst { appearance } = this.props;\r\n\t\tconst { enabled, snapTo } = this.props;\r\n\t\tconst { currentPositionRadius, currentPositionStroke } = this.props;\r\n\t\tconst { currentPositionOpacity, currentPositionStrokeWidth } = this.props;\r\n\t\tconst { hoverText, channels } = this.props;\r\n\t\tconst { current, override } = this.state;\r\n\r\n\t\tconst eachDefaultAppearance = {\r\n\t\t\t...StandardDeviationChannel.defaultProps.appearance,\r\n\t\t\t...appearance\r\n\t\t};\r\n\r\n\t\tconst hoverTextDefault = {\r\n\t\t\t...StandardDeviationChannel.defaultProps.hoverText,\r\n\t\t\t...hoverText\r\n\t\t};\r\n\r\n\t\tconst tempLine = isDefined(current) && isDefined(current.end)\r\n\t\t\t? <EachLinearRegressionChannel\r\n\t\t\t\tinteractive={false}\r\n\t\t\t\tx1Value={current.start[0]}\r\n\t\t\t\tx2Value={current.end[0]}\r\n\t\t\t\tappearance={eachDefaultAppearance}\r\n\t\t\t\thoverText={hoverTextDefault}\r\n\t\t\t/>\r\n\t\t\t: null;\r\n\r\n\t\treturn <g>\r\n\t\t\t{channels.map((each, idx) => {\r\n\t\t\t\tconst eachAppearance = isDefined(each.appearance)\r\n\t\t\t\t\t? { ...eachDefaultAppearance, ...each.appearance }\r\n\t\t\t\t\t: eachDefaultAppearance;\r\n\r\n\t\t\t\tconst eachHoverText = isDefined(each.hoverText)\r\n\t\t\t\t\t? { ...hoverTextDefault, ...each.hoverText }\r\n\t\t\t\t\t: hoverTextDefault;\r\n\r\n\t\t\t\treturn <EachLinearRegressionChannel key={idx}\r\n\t\t\t\t\tref={this.saveNodeType(idx)}\r\n\t\t\t\t\tindex={idx}\r\n\t\t\t\t\tselected={each.selected}\r\n\r\n\t\t\t\t\tx1Value={getValueFromOverride(override, idx, \"x1Value\", each.start[0])}\r\n\t\t\t\t\tx2Value={getValueFromOverride(override, idx, \"x2Value\", each.end[0])}\r\n\r\n\t\t\t\t\tappearance={eachAppearance}\r\n\t\t\t\t\tsnapTo={snapTo}\r\n\t\t\t\t\thoverText={eachHoverText}\r\n\r\n\t\t\t\t\tonDrag={this.handleDragLine}\r\n\t\t\t\t\tonDragComplete={this.handleDragLineComplete}\r\n\t\t\t\t\tedgeInteractiveCursor=\"react-stockcharts-move-cursor\"\r\n\t\t\t\t/>;\r\n\t\t\t})}\r\n\t\t\t{tempLine}\r\n\t\t\t<MouseLocationIndicator\r\n\t\t\t\tenabled={enabled}\r\n\t\t\t\tsnap\r\n\t\t\t\tsnapTo={snapTo}\r\n\t\t\t\tr={currentPositionRadius}\r\n\t\t\t\tstroke={currentPositionStroke}\r\n\t\t\t\topacity={currentPositionOpacity}\r\n\t\t\t\tstrokeWidth={currentPositionStrokeWidth}\r\n\t\t\t\tonMouseDown={this.handleStart}\r\n\t\t\t\tonClick={this.handleEnd}\r\n\t\t\t\tonMouseMove={this.handleDrawLine}\r\n\t\t\t/>\r\n\t\t</g>;\r\n\t}\r\n}\r\n\r\nStandardDeviationChannel.propTypes = {\r\n\tenabled: PropTypes.bool.isRequired,\r\n\tsnapTo: PropTypes.func,\r\n\r\n\tonStart: PropTypes.func,\r\n\tonComplete: PropTypes.func.isRequired,\r\n\tonSelect: PropTypes.func,\r\n\r\n\tcurrentPositionStroke: PropTypes.string,\r\n\tcurrentPositionStrokeWidth: PropTypes.number,\r\n\tcurrentPositionOpacity: PropTypes.number,\r\n\tcurrentPositionRadius: PropTypes.number,\r\n\r\n\tappearance: PropTypes.shape({\r\n\t\tstroke: PropTypes.string,\r\n\t\tstrokeOpacity: PropTypes.number,\r\n\t\tstrokeWidth: PropTypes.number,\r\n\t\tfill: PropTypes.string,\r\n\t\tfillOpacity: PropTypes.number,\r\n\t\tedgeStrokeWidth: PropTypes.number,\r\n\t\tedgeStroke: PropTypes.string,\r\n\t\tedgeFill: PropTypes.string,\r\n\t\tr: PropTypes.number,\r\n\t}).isRequired,\r\n\r\n\thoverText: PropTypes.object,\r\n\tchannels: PropTypes.array.isRequired,\r\n};\r\n\r\nStandardDeviationChannel.defaultProps = {\r\n\tsnapTo: d => d.close,\r\n\tappearance: {\r\n\t\tstroke: \"#000000\",\r\n\t\tfillOpacity: 0.2,\r\n\t\tstrokeOpacity: 1,\r\n\t\tstrokeWidth: 1,\r\n\t\tfill: \"#8AAFE2\",\r\n\t\tedgeStrokeWidth: 2,\r\n\t\tedgeStroke: \"#000000\",\r\n\t\tedgeFill: \"#FFFFFF\",\r\n\t\tr: 5,\r\n\t},\r\n\r\n\tonStart: noop,\r\n\tonComplete: noop,\r\n\tonSelect: noop,\r\n\r\n\tcurrentPositionStroke: \"#000000\",\r\n\tcurrentPositionOpacity: 1,\r\n\tcurrentPositionStrokeWidth: 3,\r\n\tcurrentPositionRadius: 4,\r\n\r\n\thoverText: {\r\n\t\t...HoverTextNearMouse.defaultProps,\r\n\t\tenable: true,\r\n\t\tbgHeight: \"auto\",\r\n\t\tbgWidth: \"auto\",\r\n\t\ttext: \"Click and drag the edge circles\",\r\n\t\tselectedText: \"\"\r\n\t},\r\n\tchannels: [],\r\n};\r\n\r\nexport default StandardDeviationChannel;\r\n"]}