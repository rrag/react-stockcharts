{"version":3,"sources":["../../../src/lib/interactive/wrapper/EachText.js"],"names":["EachText","props","handleHover","bind","handleDragStart","handleDrag","isHover","saveNodeType","nodes","state","hover","moreProps","position","mouseXY","yScale","chartConfig","xScale","mouseX","mouseY","textCX","textCY","dx","dy","dragStartPosition","index","onDrag","xAccessor","plotData","xValue","invert","xyValue","hovering","setState","bgFill","bgOpacity","bgStroke","bgStrokeWidth","textFill","fontFamily","fontSize","fontWeight","fontStyle","text","hoverText","selected","onDragComplete","hoverHandler","onHover","onUnHover","hoverTextEnabled","enable","hoverTextSelected","selectedText","hoverTextUnselected","restHoverTextProps","propTypes","number","array","isRequired","string","bool","func","object","defaultProps","fill","bgHeight","bgWidth"],"mappings":";;;;;;;;;;;;AAAA;;;;AACA;;;;AAEA;;AACA;;AACA;;AAEA;;;;AACA;;;;;;;;;;;;;;IAEMA,Q;;;AACL,mBAAYC,KAAZ,EAAmB;AAAA;;AAAA,kHACZA,KADY;;AAGlB,QAAKC,WAAL,GAAmB,MAAKA,WAAL,CAAiBC,IAAjB,OAAnB;;AAEA,QAAKC,eAAL,GAAuB,MAAKA,eAAL,CAAqBD,IAArB,OAAvB;AACA,QAAKE,UAAL,GAAkB,MAAKA,UAAL,CAAgBF,IAAhB,OAAlB;;AAEA,QAAKG,OAAL,GAAe,gBAAQH,IAAR,OAAf;AACA,QAAKI,YAAL,GAAoB,qBAAaJ,IAAb,OAApB;AACA,QAAKK,KAAL,GAAa,EAAb;;AAEA,QAAKC,KAAL,GAAa;AACZC,UAAO;AADK,GAAb;AAZkB;AAelB;;;;kCACeC,S,EAAW;AAAA,OAEzBC,QAFyB,GAGtB,KAAKX,KAHiB,CAEzBW,QAFyB;AAAA,OAIlBC,OAJkB,GAINF,SAJM,CAIlBE,OAJkB;AAAA,OAKHC,MALG,GAKkBH,SALlB,CAKlBI,WALkB,CAKHD,MALG;AAAA,OAKOE,MALP,GAKkBL,SALlB,CAKOK,MALP;;AAAA,iCAMDH,OANC;AAAA,OAMnBI,MANmB;AAAA,OAMXC,MANW;;AAAA,kCAQDN,QARC;AAAA,OAQnBO,MARmB;AAAA,OAQXC,MARW;;AAS1B,OAAMC,KAAKJ,SAASD,OAAOG,MAAP,CAApB;AACA,OAAMG,KAAKJ,SAASJ,OAAOM,MAAP,CAApB;;AAEA,QAAKG,iBAAL,GAAyB;AACxBX,sBADwB,EACdS,MADc,EACVC;AADU,IAAzB;AAGA;;;6BACUX,S,EAAW;AAAA,gBACK,KAAKV,KADV;AAAA,OACbuB,KADa,UACbA,KADa;AAAA,OACNC,MADM,UACNA,MADM;;AAAA,2CASjBd,SATiB,CAGpBE,OAHoB;AAAA,OAGRK,MAHQ;AAAA,OAILJ,MAJK,GASjBH,SATiB,CAIpBI,WAJoB,CAILD,MAJK;AAAA,OAKpBY,SALoB,GASjBf,SATiB,CAKpBe,SALoB;AAAA,OAMpBb,OANoB,GASjBF,SATiB,CAMpBE,OANoB;AAAA,OAOpBc,QAPoB,GASjBhB,SATiB,CAOpBgB,QAPoB;AAAA,OAQpBX,MARoB,GASjBL,SATiB,CAQpBK,MARoB;;AAAA,4BAWF,KAAKO,iBAXH;AAAA,OAWbF,EAXa,sBAWbA,EAXa;AAAA,OAWTC,EAXS,sBAWTA,EAXS;;AAYrB,OAAMM,SAASZ,OAAOa,MAAP,CACdb,OAAO,8BAAUA,MAAV,EAAkBU,SAAlB,EAA6Bb,OAA7B,EAAsCc,QAAtC,CAAP,IAA0DN,EAD5C,CAAf;AAGA;AACA,OAAMS,UAAU,CACfF,MADe,EAEfd,OAAOe,MAAP,CAAcX,SAASI,EAAvB,CAFe,CAAhB;;AAKAG,UAAOD,KAAP,EAAcM,OAAd;AACA;;;8BACWnB,S,EAAW;AACtB,OAAI,KAAKF,KAAL,CAAWC,KAAX,KAAqBC,UAAUoB,QAAnC,EAA6C;AAC5C,SAAKC,QAAL,CAAc;AACbtB,YAAOC,UAAUoB;AADJ,KAAd;AAGA;AACD;;;2BACQ;AAAA,iBAgBJ,KAAK9B,KAhBD;AAAA,OAEPW,QAFO,WAEPA,QAFO;AAAA,OAGPqB,MAHO,WAGPA,MAHO;AAAA,OAIPC,SAJO,WAIPA,SAJO;AAAA,OAKPC,QALO,WAKPA,QALO;AAAA,OAMPC,aANO,WAMPA,aANO;AAAA,OAOPC,QAPO,WAOPA,QAPO;AAAA,OAQPC,UARO,WAQPA,UARO;AAAA,OASPC,QATO,WASPA,QATO;AAAA,OAUPC,UAVO,WAUPA,UAVO;AAAA,OAWPC,SAXO,WAWPA,SAXO;AAAA,OAYPC,IAZO,WAYPA,IAZO;AAAA,OAaPC,SAbO,WAaPA,SAbO;AAAA,OAcPC,QAdO,WAcPA,QAdO;AAAA,OAePC,cAfO,WAePA,cAfO;AAAA,OAiBAnC,KAjBA,GAiBU,KAAKD,KAjBf,CAiBAC,KAjBA;;;AAmBR,OAAMoC,eAAe;AACpBC,aAAS,KAAK7C,WADM;AAEpB8C,eAAW,KAAK9C;AAFI,IAArB;;AAnBQ,OAyBC+C,gBAzBD,GA6BJN,SA7BI,CAyBPO,MAzBO;AAAA,OA0BOC,iBA1BP,GA6BJR,SA7BI,CA0BPS,YA1BO;AAAA,OA2BDC,mBA3BC,GA6BJV,SA7BI,CA2BPD,IA3BO;AAAA,OA4BJY,kBA5BI,4BA6BJX,SA7BI;;AA+BR,UAAO;AAAA;AAAA;AACN;AACC,UAAK,KAAKpC,YAAL,CAAkB,MAAlB,CADN;AAEC,eAAUqC,YAAYlC,KAFvB;AAGC,6BAAuB;AAHxB,OAIKoC,YAJL;;AAMC,kBAAa,KAAK1C,eANnB;AAOC,aAAQ,KAAKC,UAPd;AAQC,qBAAgBwC,cARjB;AASC,eAAUjC,QATX;AAUC,aAAQqB,MAVT;AAWC,gBAAWC,SAXZ;AAYC,eAAUC,YAAYE,QAZvB;AAaC,oBAAeD,aAbhB;AAcC,eAAUC,QAdX;AAeC,iBAAYC,UAfb;AAgBC,gBAAWG,SAhBZ;AAiBC,iBAAYD,UAjBb;AAkBC,eAAUD,QAlBX;AAmBC,WAAMG;AAnBP,OADM;AAsBN;AACC,WAAMO,oBAAoBvC;AAD3B,OAEK4C,kBAFL;AAGC,WAAMV,WAAWO,iBAAX,GAA+BE;AAHtC;AAtBM,IAAP;AA4BA;;;;;AAEF;;;;;;;;;;;;;AAWArD,SAASuD,SAAT,GAAqB;AACpB/B,QAAO,oBAAUgC,MADG;;AAGpB5C,WAAU,oBAAU6C,KAAV,CAAgBC,UAHN;AAIpBzB,SAAQ,oBAAU0B,MAAV,CAAiBD,UAJL;AAKpBxB,YAAW,oBAAUsB,MAAV,CAAiBE,UALR;AAMpBtB,gBAAe,oBAAUoB,MAAV,CAAiBE,UANZ;AAOpBvB,WAAU,oBAAUwB,MAPA;AAQpBtB,WAAU,oBAAUsB,MAAV,CAAiBD,UARP;;AAUpBlB,aAAY,oBAAUmB,MAAV,CAAiBD,UAVT;AAWpBpB,aAAY,oBAAUqB,MAAV,CAAiBD,UAXT;AAYpBjB,YAAW,oBAAUkB,MAAV,CAAiBD,UAZR;AAapBnB,WAAU,oBAAUiB,MAAV,CAAiBE,UAbP;;AAepBhB,OAAM,oBAAUiB,MAAV,CAAiBD,UAfH;AAgBpBd,WAAU,oBAAUgB,IAAV,CAAeF,UAhBL;;AAkBpBjC,SAAQ,oBAAUoC,IAAV,CAAeH,UAlBH;AAmBpBb,iBAAgB,oBAAUgB,IAAV,CAAeH,UAnBX;;AAqBpBf,YAAW,oBAAUmB,MAAV,CAAiBJ;AArBR,CAArB;;AAwBA1D,SAAS+D,YAAT,GAAwB;AACvBtC,oBADuB;AAEvBoB,4BAFuB;AAGvBX,YAAW,CAHY;AAIvBE,gBAAe,CAJQ;AAKvBQ,WAAU,KALa;AAMvBoB,OAAM,SANiB;AAOvBrB,yBACI,6BAAmBoB,YADvB;AAECb,UAAQ,IAFT;AAGCe,YAAU,MAHX;AAICC,WAAS,MAJV;AAKCxB,QAAM;AALP;AAPuB,CAAxB;;kBAgBe1C,Q","file":"EachText.js","sourcesContent":["import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nimport { noop } from \"../../utils\";\r\nimport { saveNodeType, isHover } from \"../utils\";\r\nimport { getXValue } from \"../../utils/ChartDataUtil\";\r\n\r\nimport HoverTextNearMouse from \"../components/HoverTextNearMouse\";\r\nimport InteractiveText from \"../components/InteractiveText\";\r\n\r\nclass EachText extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.handleHover = this.handleHover.bind(this);\r\n\r\n\t\tthis.handleDragStart = this.handleDragStart.bind(this);\r\n\t\tthis.handleDrag = this.handleDrag.bind(this);\r\n\r\n\t\tthis.isHover = isHover.bind(this);\r\n\t\tthis.saveNodeType = saveNodeType.bind(this);\r\n\t\tthis.nodes = {};\r\n\r\n\t\tthis.state = {\r\n\t\t\thover: false,\r\n\t\t};\r\n\t}\r\n\thandleDragStart(moreProps) {\r\n\t\tconst {\r\n\t\t\tposition,\r\n\t\t} = this.props;\r\n\t\tconst { mouseXY } = moreProps;\r\n\t\tconst { chartConfig: { yScale }, xScale } = moreProps;\r\n\t\tconst [mouseX, mouseY] = mouseXY;\r\n\r\n\t\tconst [textCX, textCY] = position;\r\n\t\tconst dx = mouseX - xScale(textCX);\r\n\t\tconst dy = mouseY - yScale(textCY);\r\n\r\n\t\tthis.dragStartPosition = {\r\n\t\t\tposition, dx, dy\r\n\t\t};\r\n\t}\r\n\thandleDrag(moreProps) {\r\n\t\tconst { index, onDrag } = this.props;\r\n\t\tconst {\r\n\t\t\tmouseXY: [, mouseY],\r\n\t\t\tchartConfig: { yScale },\r\n\t\t\txAccessor,\r\n\t\t\tmouseXY,\r\n\t\t\tplotData,\r\n\t\t\txScale,\r\n\t\t} = moreProps;\r\n\r\n\t\tconst { dx, dy } = this.dragStartPosition;\r\n\t\tconst xValue = xScale.invert(\r\n\t\t\txScale(getXValue(xScale, xAccessor, mouseXY, plotData)) - dx\r\n\t\t);\r\n\t\t// xScale.invert(xScale(xAccessor(currentItem)) - dx);\r\n\t\tconst xyValue = [\r\n\t\t\txValue,\r\n\t\t\tyScale.invert(mouseY - dy)\r\n\t\t];\r\n\r\n\t\tonDrag(index, xyValue);\r\n\t}\r\n\thandleHover(moreProps) {\r\n\t\tif (this.state.hover !== moreProps.hovering) {\r\n\t\t\tthis.setState({\r\n\t\t\t\thover: moreProps.hovering\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\trender() {\r\n\t\tconst {\r\n\t\t\tposition,\r\n\t\t\tbgFill,\r\n\t\t\tbgOpacity,\r\n\t\t\tbgStroke,\r\n\t\t\tbgStrokeWidth,\r\n\t\t\ttextFill,\r\n\t\t\tfontFamily,\r\n\t\t\tfontSize,\r\n\t\t\tfontWeight,\r\n\t\t\tfontStyle,\r\n\t\t\ttext,\r\n\t\t\thoverText,\r\n\t\t\tselected,\r\n\t\t\tonDragComplete,\r\n\t\t} = this.props;\r\n\t\tconst { hover } = this.state;\r\n\r\n\t\tconst hoverHandler = {\r\n\t\t\tonHover: this.handleHover,\r\n\t\t\tonUnHover: this.handleHover\r\n\t\t};\r\n\r\n\t\tconst {\r\n\t\t\tenable: hoverTextEnabled,\r\n\t\t\tselectedText: hoverTextSelected,\r\n\t\t\ttext: hoverTextUnselected,\r\n\t\t\t...restHoverTextProps\r\n\t\t} = hoverText;\r\n\r\n\t\treturn <g>\r\n\t\t\t<InteractiveText\r\n\t\t\t\tref={this.saveNodeType(\"text\")}\r\n\t\t\t\tselected={selected || hover}\r\n\t\t\t\tinteractiveCursorClass=\"react-stockcharts-move-cursor\"\r\n\t\t\t\t{...hoverHandler}\r\n\r\n\t\t\t\tonDragStart={this.handleDragStart}\r\n\t\t\t\tonDrag={this.handleDrag}\r\n\t\t\t\tonDragComplete={onDragComplete}\r\n\t\t\t\tposition={position}\r\n\t\t\t\tbgFill={bgFill}\r\n\t\t\t\tbgOpacity={bgOpacity}\r\n\t\t\t\tbgStroke={bgStroke || textFill}\r\n\t\t\t\tbgStrokeWidth={bgStrokeWidth}\r\n\t\t\t\ttextFill={textFill}\r\n\t\t\t\tfontFamily={fontFamily}\r\n\t\t\t\tfontStyle={fontStyle}\r\n\t\t\t\tfontWeight={fontWeight}\r\n\t\t\t\tfontSize={fontSize}\r\n\t\t\t\ttext={text}\r\n\t\t\t/>\r\n\t\t\t<HoverTextNearMouse\r\n\t\t\t\tshow={hoverTextEnabled && hover}\r\n\t\t\t\t{...restHoverTextProps}\r\n\t\t\t\ttext={selected ? hoverTextSelected : hoverTextUnselected}\r\n\t\t\t/>\r\n\t\t</g>;\r\n\t}\r\n}\r\n/*\r\nexport function getNewXY(moreProps, snapTo) {\r\n\tconst { xScale, xAccessor, plotData, mouseXY } = moreProps;\r\n\r\n\tconst currentItem = getCurrentItem(xScale, xAccessor, mouseXY, plotData);\r\n\tconst x = xAccessor(currentItem);\r\n\tconst y = snapTo(currentItem);\r\n\r\n\treturn [x, y];\r\n}\r\n */\r\nEachText.propTypes = {\r\n\tindex: PropTypes.number,\r\n\r\n\tposition: PropTypes.array.isRequired,\r\n\tbgFill: PropTypes.string.isRequired,\r\n\tbgOpacity: PropTypes.number.isRequired,\r\n\tbgStrokeWidth: PropTypes.number.isRequired,\r\n\tbgStroke: PropTypes.string,\r\n\ttextFill: PropTypes.string.isRequired,\r\n\r\n\tfontWeight: PropTypes.string.isRequired,\r\n\tfontFamily: PropTypes.string.isRequired,\r\n\tfontStyle: PropTypes.string.isRequired,\r\n\tfontSize: PropTypes.number.isRequired,\r\n\r\n\ttext: PropTypes.string.isRequired,\r\n\tselected: PropTypes.bool.isRequired,\r\n\r\n\tonDrag: PropTypes.func.isRequired,\r\n\tonDragComplete: PropTypes.func.isRequired,\r\n\r\n\thoverText: PropTypes.object.isRequired,\r\n};\r\n\r\nEachText.defaultProps = {\r\n\tonDrag: noop,\r\n\tonDragComplete: noop,\r\n\tbgOpacity: 1,\r\n\tbgStrokeWidth: 1,\r\n\tselected: false,\r\n\tfill: \"#8AAFE2\",\r\n\thoverText: {\r\n\t\t...HoverTextNearMouse.defaultProps,\r\n\t\tenable: true,\r\n\t\tbgHeight: \"auto\",\r\n\t\tbgWidth: \"auto\",\r\n\t\ttext: \"Click to select object\",\r\n\t}\r\n};\r\n\r\nexport default EachText;"]}