{"version":3,"sources":["../../src/lib/helper/fitDimensions.js"],"names":["fitDimensions","getDisplayName","Series","name","displayName","WrappedComponent","props","minWidth","minHeight","ratio","width","height","getDimensions","el","w","parentNode","clientWidth","h","clientHeight","Math","max","ResponsiveComponent","handleWindowResize","bind","getWrappedInstance","saveNode","setTestCanvas","state","node","testCanvas","context","getContext","devicePixelRatio","window","backingStoreRatio","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio","addEventListener","dimensions","setState","getRatio","removeEventListener","findDOMNode","ref"],"mappings":";;;;;;;;;;kBAUwBA,a;;AAVxB;;;;AACA;;;;AAEA;;;;;;;;;;AAEA,SAASC,cAAT,CAAwBC,MAAxB,EAAgC;AAC/B,KAAMC,OAAOD,OAAOE,WAAP,IAAsBF,OAAOC,IAA7B,IAAqC,QAAlD;AACA,QAAOA,IAAP;AACA;;AAEc,SAASH,aAAT,CAAuBK,gBAAvB,EAAqD;AAAA,KAAZC,KAAY,uEAAJ,EAAI;AAAA,uBAQ/DA,KAR+D,CAGlEC,QAHkE;AAAA,KAGlEA,QAHkE,mCAGvD,GAHuD;AAAA,wBAQ/DD,KAR+D,CAIlEE,SAJkE;AAAA,KAIlEA,SAJkE,oCAItD,GAJsD;AAAA,KAKlEC,KALkE,GAQ/DH,KAR+D,CAKlEG,KALkE;AAAA,KAMlEC,KANkE,GAQ/DJ,KAR+D,CAMlEI,KANkE;AAAA,KAOlEC,MAPkE,GAQ/DL,KAR+D,CAOlEK,MAPkE;;;AAUnE,UAASC,aAAT,CAAuBC,EAAvB,EAA2B;AAC1B,MAAMC,IAAID,GAAGE,UAAH,CAAcC,WAAxB;AACA,MAAMC,IAAIJ,GAAGE,UAAH,CAAcG,YAAxB;;AAEA,SAAO;AACNR,UAAO,sBAAUA,KAAV,IAAmBA,KAAnB,GAA2BS,KAAKC,GAAL,CAASN,CAAT,EAAYP,QAAZ,CAD5B;AAENI,WAAQ,sBAAUA,MAAV,IAAoBA,MAApB,GAA6BQ,KAAKC,GAAL,CAASH,CAAT,EAAYT,SAAZ;AAF/B,GAAP;AAIA;;AAlBkE,KAmB7Da,mBAnB6D;AAAA;;AAoBlE,+BAAYf,KAAZ,EAAmB;AAAA;;AAAA,yIACZA,KADY;;AAElB,SAAKgB,kBAAL,GAA0B,MAAKA,kBAAL,CAAwBC,IAAxB,OAA1B;AACA,SAAKC,kBAAL,GAA0B,MAAKA,kBAAL,CAAwBD,IAAxB,OAA1B;AACA,SAAKE,QAAL,GAAgB,MAAKA,QAAL,CAAcF,IAAd,OAAhB;AACA,SAAKG,aAAL,GAAqB,MAAKA,aAAL,CAAmBH,IAAnB,OAArB;AACA,SAAKI,KAAL,GAAa,EAAb;AANkB;AAOlB;;AA3BiE;AAAA;AAAA,4BA4BzDC,IA5ByD,EA4BnD;AACd,SAAKA,IAAL,GAAYA,IAAZ;AACA;AA9BiE;AAAA;AAAA,iCA+BpDA,IA/BoD,EA+B9C;AACnB,SAAKC,UAAL,GAAkBD,IAAlB;AACA;AAjCiE;AAAA;AAAA,8BAkCvD;AACV,QAAI,sBAAU,KAAKC,UAAf,CAAJ,EAAgC;AAC/B,SAAMC,UAAU,KAAKD,UAAL,CAAgBE,UAAhB,CAA2B,IAA3B,CAAhB;;AAEA,SAAMC,mBAAmBC,OAAOD,gBAAP,IAA2B,CAApD;AACA,SAAME,oBAAoBJ,QAAQK,4BAAR,IACtBL,QAAQM,yBADc,IAEtBN,QAAQO,wBAFc,IAGtBP,QAAQQ,uBAHc,IAItBR,QAAQS,sBAJc,IAIY,CAJtC;;AAMA,SAAM9B,SAAQuB,mBAAmBE,iBAAjC;AACA;AACA,YAAOzB,MAAP;AACA;AACD,WAAO,CAAP;AACA;AAlDiE;AAAA;AAAA,uCAmD9C;AACnBwB,WAAOO,gBAAP,CAAwB,QAAxB,EAAkC,KAAKlB,kBAAvC;AACA,QAAMmB,aAAa7B,cAAc,KAAKgB,IAAnB,CAAnB;;AAEA;AACA,SAAKc,QAAL,cACID,UADJ;AAEChC,YAAO,sBAAUA,KAAV,IAAmBA,KAAnB,GAA2B,KAAKkC,QAAL;AAFnC;AAIA;AACA;AA7DiE;AAAA;AAAA,0CA8D3C;AACtBV,WAAOW,mBAAP,CAA2B,QAA3B,EAAqC,KAAKtB,kBAA1C;AACA;AAhEiE;AAAA;AAAA,wCAiE7C;AACpB,QAAMM,OAAO,mBAASiB,WAAT,CAAqB,KAAKjB,IAA1B,CAAb,CADoB,CAC0B;AAC9C,SAAKc,QAAL,CAAc9B,cAAcgB,IAAd,CAAd;AACA;AApEiE;AAAA;AAAA,wCAqE7C;AACpB,WAAO,KAAKA,IAAZ;AACA;AAvEiE;AAAA;AAAA,4BAwEzD;AACR,QAAMkB,MAAM,EAAEA,KAAK,KAAKrB,QAAZ,EAAZ;;AAEA,QAAI,KAAKE,KAAL,CAAWjB,KAAf,EAAsB;AACrB,YAAO,8BAAC,gBAAD;AACN,cAAQ,KAAKiB,KAAL,CAAWhB,MADb;AAEN,aAAO,KAAKgB,KAAL,CAAWjB,KAFZ;AAGN,aAAO,KAAKiB,KAAL,CAAWlB;AAHZ,QAIF,KAAKH,KAJH,EAKFwC,GALE,EAAP;AAOA,KARD,MAQO;AACN,YAAO;AAAA;AAASA,SAAT;AACN,gDAAQ,KAAK,KAAKpB,aAAlB;AADM,MAAP;AAGA;AACD;AAxFiE;;AAAA;AAAA;;AA2FnEL,qBAAoBjB,WAApB,sBAAoDH,eAAeI,gBAAf,CAApD;;AAEA,QAAOgB,mBAAP;AACA","file":"fitDimensions.js","sourcesContent":["import React, { Component } from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\n\r\nimport { isDefined } from \"../utils\";\r\n\r\nfunction getDisplayName(Series) {\r\n\tconst name = Series.displayName || Series.name || \"Series\";\r\n\treturn name;\r\n}\r\n\r\nexport default function fitDimensions(WrappedComponent, props = {}) {\r\n\r\n\tconst {\r\n\t\tminWidth = 100,\r\n\t\tminHeight = 100,\r\n\t\tratio,\r\n\t\twidth,\r\n\t\theight,\r\n\t} = props;\r\n\r\n\tfunction getDimensions(el) {\r\n\t\tconst w = el.parentNode.clientWidth;\r\n\t\tconst h = el.parentNode.clientHeight;\r\n\r\n\t\treturn {\r\n\t\t\twidth: isDefined(width) ? width : Math.max(w, minWidth),\r\n\t\t\theight: isDefined(height) ? height : Math.max(h, minHeight),\r\n\t\t};\r\n\t}\r\n\tclass ResponsiveComponent extends Component {\r\n\t\tconstructor(props) {\r\n\t\t\tsuper(props);\r\n\t\t\tthis.handleWindowResize = this.handleWindowResize.bind(this);\r\n\t\t\tthis.getWrappedInstance = this.getWrappedInstance.bind(this);\r\n\t\t\tthis.saveNode = this.saveNode.bind(this);\r\n\t\t\tthis.setTestCanvas = this.setTestCanvas.bind(this);\r\n\t\t\tthis.state = {};\r\n\t\t}\r\n\t\tsaveNode(node) {\r\n\t\t\tthis.node = node;\r\n\t\t}\r\n\t\tsetTestCanvas(node) {\r\n\t\t\tthis.testCanvas = node;\r\n\t\t}\r\n\t\tgetRatio() {\r\n\t\t\tif (isDefined(this.testCanvas)) {\r\n\t\t\t\tconst context = this.testCanvas.getContext(\"2d\");\r\n\r\n\t\t\t\tconst devicePixelRatio = window.devicePixelRatio || 1;\r\n\t\t\t\tconst backingStoreRatio = context.webkitBackingStorePixelRatio ||\r\n\t\t\t\t\t\t\t\tcontext.mozBackingStorePixelRatio ||\r\n\t\t\t\t\t\t\t\tcontext.msBackingStorePixelRatio ||\r\n\t\t\t\t\t\t\t\tcontext.oBackingStorePixelRatio ||\r\n\t\t\t\t\t\t\t\tcontext.backingStorePixelRatio || 1;\r\n\r\n\t\t\t\tconst ratio = devicePixelRatio / backingStoreRatio;\r\n\t\t\t\t// console.log(\"ratio = \", ratio);\r\n\t\t\t\treturn ratio;\r\n\t\t\t}\r\n\t\t\treturn 1;\r\n\t\t}\r\n\t\tcomponentDidMount() {\r\n\t\t\twindow.addEventListener(\"resize\", this.handleWindowResize);\r\n\t\t\tconst dimensions = getDimensions(this.node);\r\n\r\n\t\t\t/* eslint-disable react/no-did-mount-set-state */\r\n\t\t\tthis.setState({\r\n\t\t\t\t...dimensions,\r\n\t\t\t\tratio: isDefined(ratio) ? ratio : this.getRatio(),\r\n\t\t\t});\r\n\t\t\t/* eslint-enable react/no-did-mount-set-state */\r\n\t\t}\r\n\t\tcomponentWillUnmount() {\r\n\t\t\twindow.removeEventListener(\"resize\", this.handleWindowResize);\r\n\t\t}\r\n\t\thandleWindowResize() {\r\n\t\t\tconst node = ReactDOM.findDOMNode(this.node); // eslint-disable-line react/no-find-dom-node\r\n\t\t\tthis.setState(getDimensions(node));\r\n\t\t}\r\n\t\tgetWrappedInstance() {\r\n\t\t\treturn this.node;\r\n\t\t}\r\n\t\trender() {\r\n\t\t\tconst ref = { ref: this.saveNode };\r\n\r\n\t\t\tif (this.state.width) {\r\n\t\t\t\treturn <WrappedComponent\r\n\t\t\t\t\theight={this.state.height}\r\n\t\t\t\t\twidth={this.state.width}\r\n\t\t\t\t\tratio={this.state.ratio}\r\n\t\t\t\t\t{...this.props}\r\n\t\t\t\t\t{...ref}\r\n\t\t\t\t/>;\r\n\t\t\t} else {\r\n\t\t\t\treturn <div {...ref}>\r\n\t\t\t\t\t<canvas ref={this.setTestCanvas}  />\r\n\t\t\t\t</div>;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tResponsiveComponent.displayName = `fitDimensions(${ getDisplayName(WrappedComponent) })`;\r\n\r\n\treturn ResponsiveComponent;\r\n}\r\n\r\n"]}