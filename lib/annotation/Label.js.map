{"version":3,"sources":["../../src/lib/annotation/Label.js"],"names":["Label","props","renderSVG","bind","drawOnCanvas","ctx","moreProps","drawOnCanvas2","context","selectCanvas","chartConfig","getYScale","getText","text","Array","isArray","undefined","yScale","propTypes","className","string","func","oneOfType","isRequired","textAnchor","fontFamily","fontSize","number","opacity","rotate","onClick","xAccessor","xScale","datum","object","x","y","contextTypes","canvasOriginX","canvasOriginY","margin","ratio","defaultProps","canvases","bg","save","setTransform","scale","translate","left","top","restore","xPos","yPos","fill","radians","Math","PI","font","fillStyle","textAlign","beginPath","fillText"],"mappings":"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","file":"Label.js","sourcesContent":["\r\n\r\nimport React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport GenericComponent from \"../GenericComponent\";\r\n\r\nimport { isDefined, hexToRGBA, functor } from \"../utils\";\r\nimport LabelAnnotation, { defaultProps, helper } from \"./LabelAnnotation\";\r\n\r\nclass Label extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.renderSVG = this.renderSVG.bind(this);\r\n\t\tthis.drawOnCanvas = this.drawOnCanvas.bind(this);\r\n\t}\r\n\tdrawOnCanvas(ctx, moreProps) {\r\n\t\tdrawOnCanvas2(ctx, this.props, this.context, moreProps);\r\n\t}\r\n\trender() {\r\n\t\treturn <GenericComponent\r\n\t\t\tcanvasToDraw={this.props.selectCanvas}\r\n\t\t\tsvgDraw={this.renderSVG}\r\n\t\t\tcanvasDraw={this.drawOnCanvas}\r\n\t\t\tdrawOn={[]}\r\n\t\t/>;\r\n\t}\r\n\trenderSVG(moreProps) {\r\n\t\tconst { chartConfig } = moreProps;\r\n\r\n\t\treturn <LabelAnnotation yScale={getYScale(chartConfig)} {...this.props} text={getText(this.props)}/>;\r\n\t}\r\n}\r\n\r\nfunction getText(props) {\r\n\treturn functor(props.text)(props);\r\n}\r\n\r\nfunction getYScale(chartConfig) {\r\n\treturn Array.isArray(chartConfig) ? undefined : chartConfig.yScale;\r\n}\r\n\r\nLabel.propTypes = {\r\n\tclassName: PropTypes.string,\r\n\tselectCanvas: PropTypes.func,\r\n\ttext: PropTypes.oneOfType([\r\n\t\tPropTypes.string,\r\n\t\tPropTypes.func\r\n\t]).isRequired,\r\n\ttextAnchor: PropTypes.string,\r\n\tfontFamily: PropTypes.string,\r\n\tfontSize: PropTypes.number,\r\n\topacity: PropTypes.number,\r\n\trotate: PropTypes.number,\r\n\tonClick: PropTypes.func,\r\n\txAccessor: PropTypes.func,\r\n\txScale: PropTypes.func,\r\n\tyScale: PropTypes.func,\r\n\tdatum: PropTypes.object,\r\n\tx: PropTypes.oneOfType([\r\n\t\tPropTypes.number,\r\n\t\tPropTypes.func\r\n\t]),\r\n\ty: PropTypes.oneOfType([\r\n\t\tPropTypes.number,\r\n\t\tPropTypes.func\r\n\t])\r\n};\r\n\r\nLabel.contextTypes = {\r\n\tcanvasOriginX: PropTypes.number,\r\n\tcanvasOriginY: PropTypes.number,\r\n\r\n\tmargin: PropTypes.object.isRequired,\r\n\tratio: PropTypes.number.isRequired,\r\n};\r\n\r\nLabel.defaultProps = {\r\n\t...defaultProps,\r\n\tselectCanvas: canvases => canvases.bg,\r\n};\r\n\r\nfunction drawOnCanvas2(ctx, props, context, moreProps) {\r\n\tctx.save();\r\n\r\n\tconst { canvasOriginX, canvasOriginY, margin, ratio } = context;\r\n\tctx.setTransform(1, 0, 0, 1, 0, 0);\r\n\tctx.scale(ratio, ratio);\r\n\r\n\r\n\tif (isDefined(canvasOriginX))\r\n\t\tctx.translate(canvasOriginX, canvasOriginY);\r\n\telse\r\n\t\tctx.translate(margin.left + (0.5 * ratio), margin.top + (0.5 * ratio));\r\n\r\n\tdrawOnCanvas(ctx, props, moreProps);\r\n\r\n\tctx.restore();\r\n\r\n}\r\n\r\nfunction drawOnCanvas(ctx, props, moreProps) {\r\n\tconst { textAnchor, fontFamily, fontSize, opacity, rotate } = props;\r\n\tconst { xScale, chartConfig, xAccessor } = moreProps;\r\n\r\n\tconst { xPos, yPos, fill, text } = helper(props, xAccessor, xScale, getYScale(chartConfig));\r\n\r\n\tconst radians = (rotate / 180) * Math.PI;\r\n\tctx.save();\r\n\tctx.translate(xPos, yPos);\r\n\tctx.rotate(radians);\r\n\r\n\tctx.font = `${ fontSize }px ${ fontFamily }`;\r\n\tctx.fillStyle = hexToRGBA(fill, opacity);\r\n\tctx.textAlign = textAnchor === \"middle\" ? \"center\" : textAnchor;\r\n\r\n\tctx.beginPath();\r\n\tctx.fillText(text, 0, 0);\r\n\tctx.restore();\r\n}\r\n\r\n\r\nexport default Label;\r\n"]}